create database employee;
use employee;

CREATE TABLE DEPT (
DEPTNO VARCHAR(10) PRIMARY KEY,
DNAME VARCHAR(50) NOT NULL,
DLOC VARCHAR(50)
);

INSERT INTO DEPT VALUES 
(10,'HR','Bengaluru'),
(20,'Finance','Hyderabad'),
(30,'IT','Mysuru'),
(40,'Sales','Chennai'),
(50,'Marketing','Pune'),
(60,'R&D','Delhi');

CREATE TABLE PROJECT (
PNO VARCHAR(10) PRIMARY KEY,
PNAME VARCHAR(50),
PLOC VARCHAR(50)
);

INSERT INTO PROJECT VALUES 
(1001,'Payroll System','Bengaluru'),
(1002,'Tax Automation','Hyderabad'),
(1003,'ERP Upgrade','Mysuru'),
(1004,'CRM App','Chennai'),
(1005,'Ad Campaign','Pune'),
(1006,'AI Research','Delhi');


CREATE TABLE EMPLOYEE (
EMPNO VARCHAR(10) PRIMARY KEY,
ENAME VARCHAR(50) NOT NULL,
MGR_NO VARCHAR(10),
HIREDATE DATE,
SAL DECIMAL(10,2),
DEPTNO VARCHAR(10),
FOREIGN KEY (DEPTNO) REFERENCES DEPT (DEPTNO)
);

INSERT INTO EMPLOYEE VALUES 
('E101','Aarav',NULL,'2025-01-01',75000.00,'10'),
('E102','Diya','E101','2025-02-01',55000.00,'20'),
('E103','Ravi','E101','2025-02-15',60000.00,'30'),
('E104','Kiran','E103','2025-03-01',50000.00,'30'),
('E105','Meena','E101','2025-03-10',52000.00,'40'),
('E106','Rohit','E101','2025-04-01',70000.00,'60');


CREATE TABLE INCENTIVES (
EMPNO VARCHAR(10),
INCENTIVE_DATE DATE,
INCENTIVE_AMOUNT DECIMAL(10 , 2 ),
PRIMARY KEY (EMPNO , INCENTIVE_DATE),
FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE (EMPNO)
);

INSERT INTO INCENTIVES VALUES 
('E101','2025-01-15',5000),
('E102','2025-02-20',3000),
('E104','2025-03-10',2500),
('E105','2025-03-15',2000),
('E106','2025-04-01',6000),
('E101','2025-05-01',1500);

CREATE TABLE ASSIGNED_TO (
EMPNO VARCHAR(10),
PNO VARCHAR(10),
JOB_ROLE VARCHAR(50),
PRIMARY KEY (EMPNO , PNO),
FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE (EMPNO),
FOREIGN KEY (PNO) REFERENCES PROJECT (PNO)
);

INSERT INTO ASSIGNED_TO VALUES 
('E101',1001,'Manager'),
('E102',1002,'Analyst'),
('E103',1003,'Developer'),
('E104',1003,'Tester'),
('E105',1004,'Sales Executive'),
('E106',1006,'Researcher');

SELECT e.EMPNO
FROM EMPLOYEE e, PROJECT p, ASSIGNED_TO a
WHERE a.PNO=P.PNO AND a.EMPNO=e.EMPNO AND p.PLOC IN ('BENGALURU', 'HYDERABAD', 'MYSURU');

SELECT e.EMPNO
FROM EMPLOYEE e
WHERE NOT EXISTS( SELECT 'X'
FROM INCENTIVES i 
WHERE e.EMPNO=i.EMPNO);

SELECT e.ENAME, e.EMPNO, d.DNAME, A.JOB_ROLE, d.DLOC, p.PLOC
FROM EMPLOYEE e, DEPT d, PROJECT p, ASSIGNED_TO a
WHERE e.EMPNO=a.EMPNO AND a.PNO=p.PNO AND e.DEPTNO=d.DEPTNO AND
D.DLOC=P.PLOC;

